* INA149
*****************************************************************************
* (C) COPYRIGHT 2011 TEXAS INSTRUMENTS INCORPORATED. ALL RIGHTS RESERVED.                                            
*****************************************************************************
** THIS MODEL IS DESIGNED AS AN AID FOR CUSTOMERS OF TEXAS INSTRUMENTS.
** TI AND ITS LICENSORS AND SUPPLIERS MAKE NO WARRANTIES, EITHER EXPRESSED
** OR IMPLIED, WITH RESPECT TO THIS MODEL, INCLUDING THE WARRANTIES OF 
** MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.  THE MODEL IS
** PROVIDED SOLELY ON AN "AS IS" BASIS.  THE ENTIRE RISK AS TO ITS QUALITY
** AND PERFORMANCE IS WITH THE CUSTOMER.
*****************************************************************************
*
** RELEASED BY: ANALOG ELAB DESIGN CENTER, TEXAS INSTRUMENTS INC.
* PART: INA149
* DATE: 11/17/2011
* MODEL TYPE: ALL IN ONE
* SIMULATOR: TINA-TI
* SIMULATOR VERSION: 7.0.30.267 SF-TI
* EVM ORDER NUMBER: N/A 
* EVM USERS GUIDE: N/A
* DATASHEET: SBOS579 - SEPTEMBER 2011
*
* MODEL VERSION: 1.0
*
*****************************************************************************
*
* UPDATES:
*
* VERSION 1.0 : RELEASE TO WEB 
*
*****************************************************************************
* NOTES: 
*
* REV A BY MAREK LIS; NOVEMBER 16, 2011
*
* THIS MACROMODEL HAS BEEN OPTIMIZED TO MODEL THE AC, DC, NOISE, AND TRANSIENT RESPONSE PERFORMANCE WITHIN 
* THE DEVICE DATA SHEET SPECIFIED LIMITS. CORRECT OPERATION OF THIS MACROMODEL HAS BEEN VERIFIED ON DESIGNSOFT
* TINA VERSION 7.0.80.224 SF. FOR HELP WITH OTHER ANALOG SIMULATION SOFTWARE, PLEASE CONSULT THE SOFTWARE SUPPLIER.
*
*  
* BEGIN MODEL INA149
*GREEN-LIS MACRO-MODEL ARCHITECTURE SIMULATED FEATURES:
*INPUT COMMON MODE REJECTION WITH FREQUENCY
*POWER SUPPLY REJECTION WITH FREQUENCY
*INPUT IMPEDANCE VS FREQUENCY 
*OUTPUT IMPEDANCE VS OUTPUT CURRENT
*INPUT VOLTAGE NOISE VS FREQUENCY
*INPUT CURRENT NOISE VS FREQUENCY 
*OUTPUT VOLTAGE SWING VS OUTPUT CURRENT
*SHORT-CIRCUIT OUTPUT CURRENT
*QUIESCENT CURRENT VS SUPPLY VOLTAGE
*SETTLING TIME VS CAPACITIVE LOAD
*SLEW RATE
*SMALL SIGNAL OVERSHOOT VS CAPACITIVE LOAD
*LARGE SIGNAL RESPONSE
*OVERLOAD RECOVERY TIME
*INPUT VOLTAGE OFFSET
*INPUT COMMON MODE RANGE
*OUTPUT CURRENT COMING THROUGH THE SUPPLY RAILS
****************************************************************************


.SUBCKT INA149 +IN REF_A V+ VOUT V- REF_B -IN
XU1         8 9 V- V+ VOUT OPA149_0
RrefB       REF_B 8 20K 
RrefA       9 REF_A 19K 
R3          +IN 9 380K 
R2          -IN 8 380K 
R1          8 VOUT 380K 
.ENDS

.SUBCKT OPA149_0  -IN +IN V- V+ VOUT
V12         9 36 1.5
VOS         8 39 -610N
V11         41 42 100M
V10         43 44 100M
V6          7 49 10
V5          50 7 10
V4          46 48 800M
V1          47 45 1.2
V9          63 24 1.5
V8          71 V- 1
V7          V+ 72 1
IS2         V+ 8 4P
IS1         V+ V- 775U
IS3         32 V- -2P
V3          73 7 25
V2          7 74 28
R42         27 28 95 
C3          23 7 50F 
L6          29 7 1U IC=0 
XU14        30 7 31 32 VCVS_LIMIT_0
L4          33 7 31.6U IC=0 
R41         29 30 1 
GVCCS9      7 30 7 34  1
RCM         33 34 1 
GVCCS7      7 34 8 7  10U
XU13        9 35 IDEAL_D_0
EVCVS7      36 7 V- 7  1
R40         7 21 1K 
R39         7 21 1K 
R38         7 10 1K 
R37         7 11 1K 
ECS1        7 0 VALUE = {(V(V+,0)+V(V-,0))*0.5}
R32         14 7 1K 
R31         15 7 1K 
R30         14 7 1K 
R24         7 15 1K 
R15         37 7 1K 
R10         7 38 1K 
R8          7 12 100K 
R3          7 13 100K 
C15         V+ V- 10P IC=0 
C22         7 16 1P 
R29         16 18 1 
C23         7 22 1P IC=0 
C9          40 7 10P IC=0 
R26         40 21 10 
C21         7 10 1P IC=0 
C20         7 11 1P IC=0 
C19         14 7 1P IC=0 
C17         15 7 1P IC=0 
C16         7 37 1P IC=0 
C12         38 7 1P IC=0 
C4          17 7 1P
R13         27 22 1 
SW14        13 12 10 7  S_VSWITCH_1
SW13        12 13 7 11  S_VSWITCH_2
R36         22 44 1M 
R35         22 42 1M 
SW12        45 41 14 7  S_VSWITCH_3
SW11        43 46 7 15  S_VSWITCH_4
R34         22 47 1K 
R33         22 48 1K 
SW10        50 18 16 7  S_VSWITCH_5
SW9         18 49 7 16  S_VSWITCH_6
R25         51 14 1 
R19         52 15 1 
R16         53 37 1 
R14         54 38 1 
R12         55 10 1 
R7          56 11 1 
R5          57 19 10M 
R6          58 18 10M 
R4          59 17 10M 
C18         19 7 1P 
C13         60 7 1F
XR109       60 7 RNOISE_FREE_0
GVCCS1      7 60 20 7  1U
R28         19 7 1K 
R27         17 7 1K 
GISINKING   V- 7 61 7  1M
GISOURCING  V+ 7 62 7  1M
R23         61 7 10K 
SW7         21 61 40 7  S_VSWITCH_7
R21         7 62 10K 
SW8         21 62 40 7  S_VSWITCH_8
SW4         58 55 10 7  S_VSWITCH_9
SW3         56 58 7 11  S_VSWITCH_10
XU3         46 23 56 7 VCVS_LIMIT_1
XU1         45 23 55 7 VCVS_LIMIT_1
SW2         59 51 14 7  S_VSWITCH_11
SW1         52 59 7 15  S_VSWITCH_12
XU8         8 V+ IDEAL_D_1
XU12        V- 8 IDEAL_D_1
EVCVS6      63 7 V+ 7  1
R22         64 35 100 
EVCVS4      64 7 8 7  1
XU2         35 24 IDEAL_D_0
XIN11       39 65 FEMT_0
XVN11       66 39 VNSE_0
SW6         57 53 37 7  S_VSWITCH_13
SW5         54 57 7 38  S_VSWITCH_14
R2          25 7 100K 
R1          26 7 100K 
XU26        35 32 7 67 VCCS_LIMIT_0
XU4         67 7 7 18 VCCS_LIMIT_1
L1          68 7 70N IC=0 
LPSR        69 7 60M IC=0 
XU25        70 7 31 65 VCVS_LIMIT_2
XU24        7 21 25 71 VCVS_LIMIT_3
XU23        21 7 72 26 VCVS_LIMIT_4
XU22        73 21 52 7 VCVS_LIMIT_5
XU21        74 21 51 7 VCVS_LIMIT_5
XU20        25 VOUT 53 7 VCVS_LIMIT_5
XU19        26 VOUT 54 7 VCVS_LIMIT_6
XU11        V- 32 IDEAL_D_1
XU10        32 V+ IDEAL_D_1
C10         75 7 1F 
C5          20 7 10F 
XR109_2     75 7 RNOISE_FREE_0
GVCCS15     7 75 60 7  1U
GVCCS14     7 17 19 7  1M
GVCCS13     7 19 75 7  1M
XR108       20 7 RNOISE_FREE_0
GVCCS12     7 20 76 7  1U
XR107       76 7 RNOISE_FREE_0
C11         76 7 10F 
GVCCS10     7 76 77 7  1U
R20         +IN 66 100 
R18         -IN 65 100 
XR106       77 68 RNOISE_FREE_0
GVCCS6      7 77 23 7  1U
XR105       23 7 RNOISE_FREE_0
XR104       18 7 RNOISE_FREE_1
XR103       7 67 RNOISE_FREE_0
C8          66 7 1P 
RPSR        69 70 1 
GVCCS11     7 70 V+ V-  100N
CINNCM      7 65 1P 
C7          65 66 1P 
VCCVS1_IN   28 VOUT
HCCVS1      21 7 VCCVS1_IN   1K
GVCCS5      7 23 18 7  1U
CCC         18 7 1U IC=0 
EVCVS3      27 7 17 7  1
.MODEL S_VSWITCH_1 VSWITCH (RON=10 ROFF=100MEG VON=100M VOFF=-100M)
.MODEL S_VSWITCH_2 VSWITCH (RON=10 ROFF=100MEG VON=100M VOFF=-100M)
.MODEL S_VSWITCH_3 VSWITCH (RON=1 ROFF=10MEG VON=100M VOFF=-100M)
.MODEL S_VSWITCH_4 VSWITCH (RON=1 ROFF=10MEG VON=100M VOFF=-100M)
.MODEL S_VSWITCH_5 VSWITCH (RON=1 ROFF=100MEG VON=150 VOFF=0)
.MODEL S_VSWITCH_6 VSWITCH (RON=1 ROFF=100MEG VON=150 VOFF=0)
.MODEL S_VSWITCH_7 VSWITCH (RON=1M ROFF=10MEG VON=-10M VOFF=0)
.MODEL S_VSWITCH_8 VSWITCH (RON=1M ROFF=10MEG VON=10M VOFF=0)
.MODEL S_VSWITCH_9 VSWITCH (RON=1 ROFF=10MEG VON=1 VOFF=-1)
.MODEL S_VSWITCH_10 VSWITCH (RON=1 ROFF=10MEG VON=1 VOFF=-1)
.MODEL S_VSWITCH_11 VSWITCH (RON=1 ROFF=1G VON=10 VOFF=-10)
.MODEL S_VSWITCH_12 VSWITCH (RON=1 ROFF=1G VON=10 VOFF=-10)
.MODEL S_VSWITCH_13 VSWITCH (RON=1 ROFF=10MEG VON=10 VOFF=-10)
.MODEL S_VSWITCH_14 VSWITCH (RON=1 ROFF=10MEG VON=10 VOFF=-10)
.ENDS


*VOLTAGE CONTROLLED SOURCE WITH LIMITS
.SUBCKT VCVS_LIMIT_0  VC+ VC- VOUT+ VOUT-
*              
.PARAM GAIN = 1
.PARAM VPOS = 10M
.PARAM VNEG = -10M
E1 VOUT+ VOUT- VALUE={LIMIT(GAIN*V(VC+,VC-),VNEG,VPOS)}
.ENDS VCVS_LIMIT_0 


*TG IDEAL DIODE
.SUBCKT IDEAL_D_0  A C
D1 A C DNOM
.MODEL DNOM D (TT=10P CJO=1E-18 IS=1E-15 RS=1E-3)
.ENDS IDEAL_D_0 


* NOISELESS RESISTOR
.SUBCKT RNOISE_FREE_0  1 2
*ROHMS = VALUE IN OHMS OF NOISELESS RESISTOR
.PARAM ROHMS=1E6
ERES 1 3 VALUE = { I(VSENSE) * ROHMS }
RDUMMY 30 3 1
VSENSE 30 2 DC 0V
.ENDS RNOISE_FREE_0 


*VOLTAGE CONTROLLED SOURCE WITH LIMITS
.SUBCKT VCVS_LIMIT_1  VC+ VC- VOUT+ VOUT-
*              
.PARAM GAIN = 100
.PARAM VPOS = 6000
.PARAM VNEG = -6000
E1 VOUT+ VOUT- VALUE={MAX(MIN(GAIN*V(VC+,VC-),VPOS),VNEG)}
.ENDS VCVS_LIMIT_1 


*TG IDEAL DIODE
.SUBCKT IDEAL_D_1  A C
D1 A C DNOM 
.MODEL DNOM D (TT=10P CJO=1E-18 IS=1E-15 RS=1E-3)
.ENDS IDEAL_D_1 


* BEGIN PROG NSE FEMTO AMP/RT-HZ 
.SUBCKT FEMT_0  1 2
* BEGIN SETUP OF NOISE GEN - FEMPTOAMPS/RT-HZ
* INPUT THREE VARIABLES
* SET UP INSE 1/F
* FA/RHZ AT 1/F FREQ
.PARAM NLFF=275
* FREQ FOR 1/F VAL
.PARAM FLWF=100M
* SET UP INSE FB
* FA/RHZ FLATBAND
.PARAM NVRF=120
* END USER INPUT
* START CALC VALS
.PARAM GLFF={PWR(FLWF,0.25)*NLFF/1164}
.PARAM RNVF={1.184*PWR(NVRF,2)}
.MODEL DVNF D KF={PWR(FLWF,0.5)/1E11} IS=1.0E-16
* END CALC VALS
I1 0 7 10E-3
I2 0 8 10E-3
D1 7 0 DVNF
D2 8 0 DVNF
E1 3 6 7 8 {GLFF}
R1 3 0 1E9
R2 3 0 1E9
R3 3 6 1E9
E2 6 4 5 0 10
R4 5 0 {RNVF}
R5 5 0 {RNVF}
R6 3 4 1E9
R7 4 0 1E9
G1 1 2 3 4 1E-6
C1 1 0 1E-15
C2 2 0 1E-15
C3 1 2 1E-15
.ENDS
* END PROG NSE FEMTO AMP/RT-HZ


* BEGIN PROG NSE NANO VOLT/RT-HZ
.SUBCKT VNSE_0  1 2
* BEGIN SETUP OF NOISE GEN - NANOVOLT/RT-HZ
* INPUT THREE VARIABLES
* SET UP VNSE 1/F
* NV/RHZ AT 1/F FREQ
.PARAM NLF=79
* FREQ FOR 1/F VAL
.PARAM FLW=1M
* SET UP VNSE FB
* NV/RHZ FLATBAND
.PARAM NVR=7
* END USER INPUT
* START CALC VALS
.PARAM GLF={PWR(FLW,0.25)*NLF/1164}
.PARAM RNV={1.184*PWR(NVR,2)}
.MODEL DVN D KF={PWR(FLW,0.5)/1E11} IS=1.0E-16
* END CALC VALS
I1 0 7 10E-3
I2 0 8 10E-3
D1 7 0 DVN
D2 8 0 DVN
E1 3 6 7 8 {GLF}
R1 3 0 1E9
R2 3 0 1E9
R3 3 6 1E9
E2 6 4 5 0 10
R4 5 0 {RNV}
R5 5 0 {RNV}
R6 3 4 1E9
R7 4 0 1E9
E3 1 2 3 4 1
C1 1 0 1E-15
C2 2 0 1E-15
C3 1 2 1E-15
.ENDS
* END PROG NSE NANOV/RT-HZ


*VOLTAGE CONTROLLED SOURCE WITH LIMITS
.SUBCKT VCCS_LIMIT_0  VC+ VC- IOUT+ IOUT-
*              
.PARAM GAIN = 100U
.PARAM IPOS = .5
.PARAM INEG = -.5
G1 IOUT+ IOUT- VALUE={MAX(MIN(GAIN*V(VC+,VC-),IPOS),INEG)}
.ENDS VCCS_LIMIT_0 


*VOLTAGE CONTROLLED SOURCE WITH LIMITS
.SUBCKT VCCS_LIMIT_1  VC+ VC- IOUT+ IOUT-
*              
.PARAM GAIN = 1
.PARAM IPOS = 2
.PARAM INEG = -2
G1 IOUT+ IOUT- VALUE={MAX(MIN(GAIN*V(VC+,VC-),IPOS),INEG)}
.ENDS VCCS_LIMIT_1 


*VOLTAGE CONTROLLED SOURCE WITH LIMITS
.SUBCKT VCVS_LIMIT_2  VC+ VC- VOUT+ VOUT-
*              
.PARAM GAIN = -1
.PARAM VPOS = 20M
.PARAM VNEG = -20M
E1 VOUT+ VOUT- VALUE={MAX(MIN(GAIN*V(VC+,VC-),VPOS),VNEG)}
.ENDS VCVS_LIMIT_2 


*VOLTAGE CONTROLLED SOURCE WITH LIMITS
.SUBCKT VCVS_LIMIT_3  VC+ VC- VOUT+ VOUT-
*              
.PARAM GAIN = 33M
.PARAM VPOS = 1
.PARAM VNEG = 0
E1 VOUT+ VOUT- VALUE={MIN(MAX(GAIN*V(VC+,VC-),VNEG),VPOS)}
.ENDS VCVS_LIMIT_3 


*VOLTAGE CONTROLLED SOURCE WITH LIMITS
.SUBCKT VCVS_LIMIT_4  VC+ VC- VOUT+ VOUT-
*              
.PARAM GAIN = 40M
.PARAM VPOS = 1
.PARAM VNEG = 0
E1 VOUT+ VOUT- VALUE={MIN(MAX(GAIN*V(VC+,VC-),VNEG),VPOS)}
.ENDS VCVS_LIMIT_4 


*VOLTAGE CONTROLLED SOURCE WITH LIMITS
.SUBCKT VCVS_LIMIT_5  VC+ VC- VOUT+ VOUT-
*              
.PARAM GAIN = 100
.PARAM VPOS = 5000
.PARAM VNEG = -5000
E1 VOUT+ VOUT- VALUE={MAX(MIN(GAIN*V(VC+,VC-),VPOS),VNEG)}
.ENDS VCVS_LIMIT_5 


*VOLTAGE CONTROLLED SOURCE WITH LIMITS
.SUBCKT VCVS_LIMIT_6  VC+ VC- VOUT+ VOUT-
*             
.PARAM GAIN = 100
.PARAM VPOS = 5000
.PARAM VNEG = -5000
E1 VOUT+ VOUT- VALUE={MAX(MIN(GAIN*V(VC+,VC-),VPOS),VNEG)}
.ENDS VCVS_LIMIT_6 


* NOISELESS RESISTOR
.SUBCKT RNOISE_FREE_1  1 2
*ROHMS = VALUE IN OHMS OF NOISELESS RESISTOR
.PARAM ROHMS=1E4
ERES 1 3 VALUE = { I(VSENSE) * ROHMS }
RDUMMY 30 3 1
VSENSE 30 2 DC 0V
.ENDS RNOISE_FREE_1 


.END


.END
